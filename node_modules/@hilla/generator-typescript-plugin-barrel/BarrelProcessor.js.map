{
  "version": 3,
  "sources": ["src/BarrelProcessor.ts"],
  "sourcesContent": ["import { basename, dirname } from 'path';\nimport type Plugin from '@hilla/generator-typescript-core/Plugin.js';\nimport createSourceFile from '@hilla/generator-typescript-utils/createSourceFile.js';\nimport DependencyManager from '@hilla/generator-typescript-utils/dependencies/DependencyManager.js';\nimport PathManager from '@hilla/generator-typescript-utils/dependencies/PathManager.js';\nimport type { SourceFile } from 'typescript';\n\nexport default class BarrelProcessor {\n  static readonly BARREL_FILE_NAME = 'endpoints.ts';\n  declare ['constructor']: typeof BarrelProcessor;\n  readonly #endpoints: readonly SourceFile[];\n  readonly #outputPathManager = new PathManager({ extension: 'ts' });\n  readonly #owner: Plugin;\n\n  constructor(endpoints: readonly SourceFile[], owner: Plugin) {\n    this.#endpoints = endpoints;\n    this.#owner = owner;\n  }\n\n  process(): SourceFile {\n    this.#owner.logger.debug(`Generating '${this.constructor.BARREL_FILE_NAME}' file`);\n\n    const { exports, imports } = this.#endpoints.reduce(\n      (acc, { fileName }) => {\n        const specifier = basename(fileName, '.ts');\n        const path = `${dirname(fileName)}/${specifier}`;\n\n        const id = acc.imports.namespace.add(acc.paths.createRelativePath(path), specifier);\n        acc.exports.named.add(specifier, false, id);\n\n        return acc;\n      },\n      new DependencyManager(new PathManager({ extension: '.js' })),\n    );\n\n    return createSourceFile(\n      [...imports.toCode(), ...exports.toCode()],\n      this.#outputPathManager.createRelativePath('endpoints'),\n    );\n  }\n}\n"],
  "mappings": "AAAA,OAAS,YAAAA,EAAU,WAAAC,MAAe,OAElC,OAAOC,MAAsB,wDAC7B,OAAOC,MAAuB,sEAC9B,OAAOC,MAAiB,gEAGxB,MAAOC,CAA8B,CACnC,OAAgB,iBAAmB,eAE1BC,GACAC,GAAqB,IAAIH,EAAY,CAAE,UAAW,IAAK,CAAC,EACxDI,GAET,YAAYC,EAAkCC,EAAe,CAC3D,KAAKJ,GAAaG,EAClB,KAAKD,GAASE,CAChB,CAEA,SAAsB,CACpB,KAAKF,GAAO,OAAO,MAAM,eAAe,KAAK,YAAY,gBAAgB,QAAQ,EAEjF,KAAM,CAAE,QAAAG,EAAS,QAAAC,CAAQ,EAAI,KAAKN,GAAW,OAC3C,CAACO,EAAK,CAAE,SAAAC,CAAS,IAAM,CACrB,MAAMC,EAAYf,EAASc,EAAU,KAAK,EACpCE,EAAO,GAAGf,EAAQa,CAAQ,CAAC,IAAIC,CAAS,GAExCE,EAAKJ,EAAI,QAAQ,UAAU,IAAIA,EAAI,MAAM,mBAAmBG,CAAI,EAAGD,CAAS,EAClF,OAAAF,EAAI,QAAQ,MAAM,IAAIE,EAAW,GAAOE,CAAE,EAEnCJ,CACT,EACA,IAAIV,EAAkB,IAAIC,EAAY,CAAE,UAAW,KAAM,CAAC,CAAC,CAC7D,EAEA,OAAOF,EACL,CAAC,GAAGU,EAAQ,OAAO,EAAG,GAAGD,EAAQ,OAAO,CAAC,EACzC,KAAKJ,GAAmB,mBAAmB,WAAW,CACxD,CACF,CACF",
  "names": ["basename", "dirname", "createSourceFile", "DependencyManager", "PathManager", "BarrelProcessor", "#endpoints", "#outputPathManager", "#owner", "endpoints", "owner", "exports", "imports", "acc", "fileName", "specifier", "path", "id"]
}
