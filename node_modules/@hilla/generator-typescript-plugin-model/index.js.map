{
  "version": 3,
  "sources": ["src/index.ts"],
  "sourcesContent": ["import Plugin from '@hilla/generator-typescript-core/Plugin.js';\nimport type SharedStorage from '@hilla/generator-typescript-core/SharedStorage.js';\nimport type { OpenAPIV3 } from 'openapi-types';\nimport type { ReadonlyDeep } from 'type-fest';\nimport type { SourceFile } from 'typescript';\nimport { EntityModelProcessor } from './EntityModelProcessor.js';\nimport type { Context } from './utils.js';\n\nexport enum ModelPluginSourceType {\n  Model = 'model',\n}\n\nexport default class ModelPlugin extends Plugin {\n  static readonly MODEL_PLUGIN_FILE_TAGS = 'MODEL_PLUGIN_FILE_TAGS';\n  declare ['constructor']: typeof ModelPlugin;\n  readonly #tags = new WeakMap<SourceFile, ModelPluginSourceType>();\n\n  override get path(): string {\n    return import.meta.url;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/require-await\n  override async execute(storage: SharedStorage): Promise<void> {\n    const files = this.#processEntities(storage.api.components?.schemas);\n    files.forEach((file) => this.#tags.set(file, ModelPluginSourceType.Model));\n    storage.sources.push(...files);\n    storage.pluginStorage.set(this.constructor.MODEL_PLUGIN_FILE_TAGS, this.#tags);\n  }\n\n  #processEntities(schemas: ReadonlyDeep<OpenAPIV3.ComponentsObject>['schemas'] | undefined): readonly SourceFile[] {\n    this.logger.debug('Processing entities');\n\n    if (!schemas) {\n      return [];\n    }\n\n    const ctx: Context = {\n      owner: this,\n    };\n\n    return Object.entries(schemas).map(([name, component]) => EntityModelProcessor.process(name, component, ctx));\n  }\n}\n"],
  "mappings": "AAAA,OAAOA,MAAY,6CAKnB,OAAS,wBAAAC,MAA4B,4BAG9B,IAAKC,OACVA,EAAA,MAAQ,QADEA,OAAA,IAIZ,MAAOC,UAAkCH,CAAO,CAC9C,OAAgB,uBAAyB,yBAEhCI,GAAQ,IAAI,QAErB,IAAa,MAAe,CAC1B,OAAO,YAAY,GACrB,CAGA,MAAe,QAAQC,EAAuC,CAC5D,MAAMC,EAAQ,KAAKC,GAAiBF,EAAQ,IAAI,YAAY,OAAO,EACnEC,EAAM,QAASE,GAAS,KAAKJ,GAAM,IAAII,EAAM,OAA2B,CAAC,EACzEH,EAAQ,QAAQ,KAAK,GAAGC,CAAK,EAC7BD,EAAQ,cAAc,IAAI,KAAK,YAAY,uBAAwB,KAAKD,EAAK,CAC/E,CAEAG,GAAiBE,EAAiG,CAGhH,GAFA,KAAK,OAAO,MAAM,qBAAqB,EAEnC,CAACA,EACH,MAAO,CAAC,EAGV,MAAMC,EAAe,CACnB,MAAO,IACT,EAEA,OAAO,OAAO,QAAQD,CAAO,EAAE,IAAI,CAAC,CAACE,EAAMC,CAAS,IAAMX,EAAqB,QAAQU,EAAMC,EAAWF,CAAG,CAAC,CAC9G,CACF",
  "names": ["Plugin", "EntityModelProcessor", "ModelPluginSourceType", "ModelPlugin", "#tags", "storage", "files", "#processEntities", "file", "schemas", "ctx", "name", "component"]
}
